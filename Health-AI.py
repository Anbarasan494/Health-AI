# -*- coding: utf-8 -*-
"""HealthAI(v3).ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/15QOLKu2Ky_6WOUznI15ld9_nzcG72b9N
"""

# ================================================================
# SIMPLE MEDICAL AI ASSISTANT FOR GOOGLE COLAB
# ================================================================
# Run this entire cell in Google Colab

# Install required packages
print("ğŸ”§ Installing required packages...")
!pip install -q gradio

print("âœ… Installation complete!")

# Import libraries
import gradio as gr
import random
from datetime import datetime
import warnings
warnings.filterwarnings('ignore')

print("ğŸ“š Libraries loaded successfully!")

# ================================================================
# MEDICAL KNOWLEDGE BASE (Lightweight & Rule-based)
# ================================================================

SYMPTOM_CONDITIONS = {
    "fever": ["Common cold", "Flu", "Viral infection", "Bacterial infection"],
    "headache": ["Tension headache", "Migraine", "Dehydration", "Stress", "Sinus pressure"],
    "cough": ["Common cold", "Bronchitis", "Allergies", "Throat irritation"],
    "chest pain": ["Muscle strain", "Heartburn", "Anxiety", "Costochondritis"],
    "stomach pain": ["Indigestion", "Gastritis", "Food poisoning", "Stress"],
    "fatigue": ["Lack of sleep", "Stress", "Dehydration", "Poor nutrition"],
    "dizziness": ["Low blood pressure", "Dehydration", "Inner ear issue", "Low blood sugar"],
    "nausea": ["Food poisoning", "Motion sickness", "Stress", "Medication side effect"],
    "sore throat": ["Viral infection", "Bacterial infection", "Allergies", "Dry air"],
    "back pain": ["Muscle strain", "Poor posture", "Herniated disc", "Stress tension"]
}

EMERGENCY_KEYWORDS = [
    "severe chest pain", "chest pressure", "difficulty breathing", "can't breathe",
    "unconscious", "seizure", "severe bleeding", "stroke", "heart attack",
    "severe allergic reaction", "anaphylaxis", "severe abdominal pain",
    "high fever", "temperature above 103", "severe headache", "vision loss",
    "severe burn", "broken bone", "head injury", "overdose"
]

FIRST_AID_ADVICE = {
    "fever": "ğŸŒ¡ï¸ Rest, drink plenty of fluids, use acetaminophen/ibuprofen as directed. Seek care if >101.5Â°F (38.6Â°C) or lasts >3 days",
    "headache": "ğŸ’† Rest in quiet, dark room. Stay hydrated. Gentle head/neck massage. Avoid triggers like bright lights",
    "cough": "ğŸ’§ Stay hydrated, use humidifier, honey for throat soothing. Avoid smoke and irritants",
    "chest pain": "ğŸ« Sit upright, breathe slowly and deeply. If severe, crushing, or radiating - seek immediate care",
    "stomach pain": "ğŸ½ï¸ Eat bland foods (BRAT diet), stay hydrated, avoid dairy/spicy foods. Rest and monitor",
    "fatigue": "ğŸ˜´ Ensure 7-9 hours sleep, manage stress, eat balanced meals, stay hydrated",
    "dizziness": "ğŸª‘ Sit down immediately, drink water, avoid sudden movements. Rest until it passes",
    "nausea": "ğŸ¤¢ Sip clear fluids, try ginger, eat bland foods, rest. Avoid strong smells",
    "sore throat": "ğŸ¯ Gargle warm salt water, use throat lozenges, stay hydrated, rest voice",
    "back pain": "ğŸ§˜ Apply ice/heat, gentle stretching, maintain good posture, avoid heavy lifting"
}

HEALTH_TIPS = {
    "blood pressure": "Monitor regularly, reduce sodium, exercise moderately, manage stress, maintain healthy weight",
    "weight": "Balanced diet with portion control, regular physical activity, adequate sleep, stay hydrated",
    "blood sugar": "Monitor carbohydrate intake, eat regular meals, exercise regularly, take medications as prescribed",
    "cholesterol": "Heart-healthy diet, reduce saturated fats, increase fiber, exercise regularly, avoid smoking",
    "heart rate": "Regular cardio exercise, manage stress, avoid excessive caffeine, maintain healthy weight"
}

# ================================================================
# CORE FUNCTIONS
# ================================================================

def analyze_symptoms(symptoms, severity, duration):
    """Analyze symptoms using rule-based logic"""

    if not symptoms or symptoms.strip() == "":
        return "Please describe your symptoms to get an analysis.", "NO DATA"

    symptoms_lower = symptoms.lower().strip()

    # Emergency check first
    is_emergency = any(keyword in symptoms_lower for keyword in EMERGENCY_KEYWORDS)

    if is_emergency or severity >= 9:
        return """ğŸš¨ EMERGENCY ALERT ğŸš¨

âš ï¸ This may require IMMEDIATE medical attention!

ğŸ†˜ CALL EMERGENCY SERVICES NOW:
â€¢ US/Canada: 911
â€¢ UK: 999
â€¢ India: 108
â€¢ Australia: 000

ğŸš‘ DO NOT DELAY:
â€¢ Do not drive yourself
â€¢ Have someone accompany you
â€¢ Bring medications list
â€¢ Go to nearest emergency room

Time-sensitive situation detected.""", "ğŸš¨ EMERGENCY"

    # Find matching symptoms and conditions
    possible_conditions = []
    matched_symptoms = []
    advice_list = []

    for symptom, conditions in SYMPTOM_CONDITIONS.items():
        if symptom in symptoms_lower:
            possible_conditions.extend(conditions)
            matched_symptoms.append(symptom)
            if symptom in FIRST_AID_ADVICE:
                advice_list.append(f"{FIRST_AID_ADVICE[symptom]}")

    # Risk assessment
    if severity >= 8:
        risk = "HIGH"
        urgency = "Seek medical attention today"
    elif severity >= 6:
        risk = "MODERATE"
        urgency = "Consider seeing healthcare provider within 24-48 hours"
    elif severity >= 4:
        risk = "MILD-MODERATE"
        urgency = "Monitor symptoms, see provider if worsening"
    else:
        risk = "MILD"
        urgency = "Self-care measures, monitor progress"

    # Duration factor
    duration_advice = ""
    if "week" in duration.lower() or "weeks" in duration.lower():
        duration_advice = "â° Chronic symptoms (>1 week) should be evaluated by healthcare provider."
        if risk == "MILD":
            risk = "MODERATE"

    # Generate comprehensive response
    if not possible_conditions:
        possible_conditions = ["General discomfort", "Non-specific symptoms"]

    # Remove duplicates and format
    unique_conditions = list(set(possible_conditions))

    result = f"""ğŸ“Š SYMPTOM ANALYSIS REPORT

ğŸ” **Symptoms Analyzed:** {', '.join(matched_symptoms) if matched_symptoms else 'General symptoms'}

âš ï¸ **Risk Level:** {risk}
ğŸ“‹ **Recommendation:** {urgency}

ğŸ¥ **Possible Conditions:**
{', '.join(unique_conditions[:4])}  # Limit to top 4

ğŸ’¡ **Self-Care Recommendations:**
{chr(10).join(['â€¢ ' + advice for advice in advice_list[:3]])}  # Top 3 advice

{duration_advice}

ğŸ“ **When to Seek Immediate Care:**
â€¢ Symptoms suddenly worsen
â€¢ Severe pain (8+/10)
â€¢ Difficulty breathing
â€¢ High fever >101.5Â°F (38.6Â°C)
â€¢ Persistent vomiting
â€¢ Signs of dehydration

ğŸ“… **Follow-up:**
â€¢ Monitor symptoms for 24-48 hours
â€¢ Keep symptom diary
â€¢ Contact healthcare provider if no improvement

âš ï¸ **DISCLAIMER:** This analysis is for informational purposes only. Always consult qualified healthcare professionals for proper diagnosis and treatment."""

    return result, f"ğŸ”´ {risk} RISK"

def track_health_metric(metric, current_value, target_value):
    """Simple health metric tracking"""

    try:
        current = float(current_value)
        target = float(target_value)

        # Calculate progress and direction
        if abs(current - target) < 0.01:
            progress_status = "ğŸ¯ At target!"
            progress_pct = 100.0
        elif target > current:
            progress_pct = min(100, (current / target) * 100)
            progress_status = f"ğŸ“ˆ {progress_pct:.1f}% towards target"
        else:
            progress_pct = min(100, (target / current) * 100)
            progress_status = f"ğŸ“‰ Need to reduce by {abs(current-target):.1f} units"

        # Get specific advice
        metric_lower = metric.lower()
        advice = HEALTH_TIPS.get(metric_lower, "Follow your healthcare provider's recommendations")

        # Generate ranges for context
        normal_ranges = {
            "blood pressure": "Normal: <120/80 mmHg, Pre-high: 120-139/80-89, High: â‰¥140/90",
            "blood sugar": "Normal fasting: 70-100 mg/dL, Pre-diabetes: 100-125, Diabetes: â‰¥126",
            "cholesterol": "Desirable: <200 mg/dL, Borderline: 200-239, High: â‰¥240",
            "weight": "BMI: Underweight <18.5, Normal 18.5-24.9, Overweight 25-29.9, Obese â‰¥30",
            "heart rate": "Resting: 60-100 bpm, Athletic: 40-60 bpm, Elderly: 60-100 bpm"
        }

        range_info = normal_ranges.get(metric_lower, "Consult healthcare provider for target ranges")

        result = f"""ğŸ“ˆ HEALTH TRACKING REPORT

ğŸ“Š **Metric:** {metric}
ğŸ“ **Current Value:** {current}
ğŸ¯ **Target Value:** {target}
ğŸ“‹ **Status:** {progress_status}

ğŸ“ **Reference Ranges:**
{range_info}

ğŸ’¡ **Personalized Recommendations:**
{advice}

ğŸ“… **Monitoring Schedule:**
â€¢ Daily tracking for 2 weeks
â€¢ Weekly averages thereafter
â€¢ Monthly review with healthcare provider
â€¢ Document any significant changes

âš¡ **Quick Tips:**
â€¢ Track at same time daily
â€¢ Use reliable measuring tools
â€¢ Note factors affecting readings
â€¢ Share trends with your doctor

ğŸ“± **Digital Tools:**
Consider using health apps or devices for consistent tracking

âš ï¸ **Important:** Individual targets may vary. Consult your healthcare provider for personalized goals and monitoring frequency."""

        return result

    except (ValueError, TypeError):
        return "âŒ Please enter valid numbers for current and target values."

def medical_qa_chat(question, history):
    """Handle medical Q&A with expanded knowledge"""

    if not question or question.strip() == "":
        return "", history

    question_lower = question.lower().strip()

    # Expanded response database
    qa_responses = {
        # Symptoms
        "headache": "ğŸ¤• Headaches can result from tension, dehydration, stress, lack of sleep, eye strain, or sinus issues. Try: rest in dark room, hydrate, gentle massage, cold/warm compress. See doctor if severe, sudden, or with fever/vision changes.",

        "fever": "ğŸŒ¡ï¸ Fever indicates your body is fighting infection. Management: rest, fluids, acetaminophen/ibuprofen as directed. Seek care if: >101.5Â°F (38.6Â°C), lasts >3 days, with severe symptoms, or in infants <3 months.",

        "cough": "ğŸ˜· Coughs can be from colds, allergies, infections, or irritants. Help: stay hydrated, humidifier, honey (not for babies <1yr), avoid smoke. See doctor if: blood in sputum, lasts >3 weeks, with fever/weight loss.",

        "stomach": "ğŸ¤¢ Stomach pain causes: food issues, stress, infections, medications. Try: BRAT diet, clear fluids, rest, heat pad. Emergency if: severe pain, blood in stool/vomit, signs of appendicitis, dehydration.",

        # General health
        "diet": "ğŸ¥— Healthy eating: variety of fruits/vegetables, whole grains, lean proteins, healthy fats. Limit: processed foods, added sugars, excessive sodium. Stay hydrated. Consider consulting registered dietitian for personalized plans.",

        "exercise": "ğŸƒâ€â™‚ï¸ Adults need 150 mins moderate activity weekly. Start gradually, choose enjoyable activities, include strength training 2x/week. Listen to your body, warm up/cool down. Consult doctor before starting intense programs.",

        "sleep": "ğŸ˜´ Adults need 7-9 hours nightly. Good habits: consistent schedule, cool/dark/quiet room, avoid screens 1hr before bed, limit caffeine after 2pm, relaxing bedtime routine.",

        # Specific conditions
        "diabetes": "ğŸ©¸ Diabetes management: monitor blood sugar, take medications as prescribed, healthy diet, regular exercise, foot care, eye exams. Work closely with healthcare team for optimal control.",

        "hypertension": "ğŸ’“ High blood pressure management: limit sodium, maintain healthy weight, exercise regularly, limit alcohol, manage stress, take medications as prescribed, regular monitoring.",

        "anxiety": "ğŸ˜° Anxiety management: deep breathing, regular exercise, adequate sleep, limit caffeine, mindfulness/meditation, talk therapy, support groups. Seek professional help if interfering with daily life.",

        # Prevention
        "vaccine": "ğŸ’‰ Vaccines are safe, effective prevention tools. Stay current with recommended schedules. Common adult vaccines: flu (annual), COVID-19, tetanus/diphtheria (every 10 years). Consult healthcare provider.",

        "checkup": "ğŸ¥ Regular checkups help catch issues early. Adults should see primary care provider annually. Include: vital signs, lab work, screenings based on age/risk factors, preventive counseling."
    }

    # Find relevant response
    response = None
    for keyword, answer in qa_responses.items():
        if keyword in question_lower:
            response = answer
            break

    # Default response for unmatched questions
    if not response:
        response = """ğŸ’­ I understand you have a health question. Here's general guidance:

ğŸ” **For Specific Symptoms:**
â€¢ Note severity, duration, associated symptoms
â€¢ Monitor changes over time
â€¢ Consider what might have triggered them

ğŸ¥ **When to Seek Care:**
â€¢ Severe or persistent symptoms
â€¢ Symptoms interfering with daily activities
â€¢ New or concerning changes
â€¢ Emergency warning signs

ğŸŒŸ **General Health:**
â€¢ Balanced diet and regular exercise
â€¢ Adequate sleep (7-9 hours)
â€¢ Stress management
â€¢ Preventive care and screenings

For more specific guidance, please describe your symptoms or health concerns in detail."""

    # Add timestamp and disclaimer
    timestamp = datetime.now().strftime("%H:%M")
    full_response = f"[{timestamp}] {response}\n\nâš ï¸ **Medical Disclaimer:** This information is for educational purposes only. Always consult qualified healthcare professionals for medical advice, diagnosis, and treatment."

    # Use new message format
    history.append({"role": "user", "content": question})
    history.append({"role": "assistant", "content": full_response})

    return "", history

def emergency_assessment(symptoms):
    """Quick emergency screening"""

    if not symptoms or symptoms.strip() == "":
        return "Please describe your symptoms for emergency assessment.", "âŒ NO INPUT"

    symptoms_lower = symptoms.lower().strip()

    # Check for emergency keywords
    emergency_found = []
    for keyword in EMERGENCY_KEYWORDS:
        if keyword in symptoms_lower:
            emergency_found.append(keyword)

    if emergency_found:
        return f"""ğŸš¨ POTENTIAL EMERGENCY DETECTED ğŸš¨

âš ï¸ **Emergency indicators found:** {', '.join(emergency_found)}

ğŸ†˜ **CALL EMERGENCY SERVICES IMMEDIATELY:**
â€¢ ğŸ‡ºğŸ‡¸ US/Canada: 911
â€¢ ğŸ‡¬ğŸ‡§ UK: 999
â€¢ ğŸ‡®ğŸ‡³ India: 108
â€¢ ğŸ‡¦ğŸ‡º Australia: 000
â€¢ ğŸ‡ªğŸ‡º Europe: 112

ğŸš‘ **IMMEDIATE ACTIONS:**
1. Call emergency services NOW
2. Do NOT drive yourself
3. Have someone stay with you
4. Bring medication list if possible
5. Go to nearest emergency room

â° **Time is critical** - do not delay seeking medical care.

If this is a mistake, please clarify your symptoms. When in doubt, always err on the side of caution.""", "ğŸš¨ CALL 911 NOW"

    else:
        return """âœ… **No immediate emergency indicators detected**

However, trust your instincts about your health:

ğŸ¥ **Seek immediate care if:**
â€¢ Symptoms suddenly worsen
â€¢ Severe pain or discomfort
â€¢ Difficulty breathing
â€¢ Chest pain or pressure
â€¢ Severe allergic reaction
â€¢ High fever with confusion
â€¢ Significant bleeding
â€¢ Head injury with confusion

ğŸ“ **Non-emergency options:**
â€¢ Contact your primary care provider
â€¢ Visit urgent care center
â€¢ Call nurse hotline if available
â€¢ Telehealth consultation

âš ï¸ **Remember:** This tool cannot replace medical judgment. If you feel something is seriously wrong, seek immediate medical attention.""", "â„¹ï¸ MONITOR & SEEK CARE IF NEEDED"

# ================================================================
# GRADIO INTERFACE FOR GOOGLE COLAB
# ================================================================

def create_medical_app():
    """Create the Gradio interface optimized for Colab"""

    # Custom CSS for Colab
    custom_css = """
    .gradio-container {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
    }
    .gr-form {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 20px;
        margin: 10px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.18);
    }
    .gr-button-primary {
        background: linear-gradient(45deg, #667eea, #764ba2) !important;
        border: none !important;
        border-radius: 25px !important;
        color: white !important;
        font-weight: 600 !important;
        transition: all 0.3s ease !important;
    }
    .gr-button-primary:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3) !important;
    }
    """

    with gr.Blocks(
        title="ğŸ¥ Medical AI Assistant",
        theme=gr.themes.Soft(),
        css=custom_css
    ) as app:

        # Header
        gr.HTML("""
        <div style="text-align: center; padding: 25px; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-radius: 15px; margin-bottom: 20px; border: 1px solid rgba(255, 255, 255, 0.18);">
            <h1 style="color: white; font-size: 2.5em; margin: 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                ğŸ¥ Medical AI Assistant
            </h1>
            <p style="color: rgba(255,255,255,0.9); font-size: 1.1em; margin: 10px 0;">
                ğŸ’¡ Intelligent Health Guidance & Quick Medical Information
            </p>
            <div style="background: linear-gradient(45deg, #ff6b6b, #ee5a52); border-radius: 10px; padding: 15px; margin-top: 15px;">
                <strong style="color: white;">âš ï¸ IMPORTANT MEDICAL DISCLAIMER</strong><br>
                <span style="color: rgba(255,255,255,0.95); font-size: 0.9em;">This AI provides educational information only. Always consult qualified healthcare professionals for medical advice, diagnosis, and treatment decisions.</span>
            </div>
        </div>
        """)

        # Main Interface Tabs
        with gr.Tab("ğŸ” Symptom Checker", elem_classes="gr-form"):
            gr.Markdown("### ğŸ“‹ Comprehensive Symptom Analysis")
            gr.Markdown("*Get quick insights about your symptoms and appropriate next steps*")

            with gr.Row():
                with gr.Column(scale=2):
                    symptoms_input = gr.Textbox(
                        label="ğŸ“ Describe Your Symptoms",
                        placeholder="Example: I have a persistent headache with nausea for 2 days, feeling dizzy...",
                        lines=4,
                        info="Be as specific as possible about what you're experiencing"
                    )

                    with gr.Row():
                        severity_slider = gr.Slider(
                            label="ğŸŒ¡ï¸ Pain/Discomfort Level",
                            minimum=1,
                            maximum=10,
                            value=5,
                            info="1 = Very mild, 10 = Unbearable"
                        )

                        duration_dropdown = gr.Dropdown(
                            choices=[
                                "Less than 1 day",
                                "1-2 days",
                                "3-7 days",
                                "1-2 weeks",
                                "More than 2 weeks"
                            ],
                            label="â° How Long?",
                            value="1-2 days",
                            info="Duration of symptoms"
                        )

                    analyze_button = gr.Button(
                        "ğŸ” Analyze My Symptoms",
                        variant="primary",
                        size="lg"
                    )

                with gr.Column(scale=1):
                    risk_status = gr.Textbox(
                        label="âš ï¸ Risk Assessment",
                        lines=1,
                        max_lines=1
                    )

            analysis_output = gr.Textbox(
                label="ğŸ“Š Detailed Analysis & Recommendations",
                lines=15,
                show_copy_button=True,
                info="Save or share this analysis with your healthcare provider"
            )

            analyze_button.click(
                fn=analyze_symptoms,
                inputs=[symptoms_input, severity_slider, duration_dropdown],
                outputs=[analysis_output, risk_status]
            )

        with gr.Tab("ğŸ“ˆ Health Tracker", elem_classes="gr-form"):
            gr.Markdown("### ğŸ“Š Personal Health Metrics Monitoring")
            gr.Markdown("*Track your progress toward health goals*")

            with gr.Row():
                metric_dropdown = gr.Dropdown(
                    choices=[
                        "Blood Pressure",
                        "Blood Sugar",
                        "Weight",
                        "Cholesterol",
                        "Heart Rate"
                    ],
                    label="ğŸ“Š Health Metric to Track",
                    value="Blood Pressure",
                    info="Select the health metric you want to monitor"
                )

                current_number = gr.Number(
                    label="ğŸ“ Current Value",
                    value=140,
                    info="Your most recent measurement"
                )

                target_number = gr.Number(
                    label="ğŸ¯ Target Value",
                    value=120,
                    info="Your goal or doctor-recommended target"
                )

            track_button = gr.Button(
                "ğŸ“ˆ Generate Health Report",
                variant="primary",
                size="lg"
            )

            tracking_output = gr.Textbox(
                label="ğŸ“‹ Personalized Health Tracking Report",
                lines=12,
                show_copy_button=True,
                info="Share this report with your healthcare team"
            )

            track_button.click(
                fn=track_health_metric,
                inputs=[metric_dropdown, current_number, target_number],
                outputs=[tracking_output]
            )

        with gr.Tab("ğŸš¨ Emergency Check", elem_classes="gr-form"):
            gr.Markdown("### âš¡ Rapid Emergency Symptom Screening")
            gr.Markdown("*Quick assessment for symptoms that may need immediate medical attention*")

            gr.HTML("""
            <div style="background: linear-gradient(45deg, #ff4757, #ff3742); color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center;">
                <strong>ğŸš¨ FOR TRUE EMERGENCIES: CALL 911 (US), 999 (UK), 108 (India) IMMEDIATELY</strong>
            </div>
            """)

            emergency_input = gr.Textbox(
                label="ğŸ†˜ Describe Emergency Symptoms",
                placeholder="Example: Severe chest pain, difficulty breathing, severe bleeding...",
                lines=4,
                info="Describe any urgent symptoms you're experiencing"
            )

            emergency_button = gr.Button(
                "ğŸš¨ Emergency Assessment",
                variant="stop",
                size="lg"
            )

            with gr.Row():
                emergency_result = gr.Textbox(
                    label="ğŸ†˜ Emergency Assessment Result",
                    lines=10,
                    show_copy_button=True
                )

                emergency_status = gr.Textbox(
                    label="ğŸ“‹ Priority Status",
                    lines=2,
                    max_lines=2
                )

            emergency_button.click(
                fn=emergency_assessment,
                inputs=[emergency_input],
                outputs=[emergency_result, emergency_status]
            )

        with gr.Tab("ğŸ’¬ Health Q&A", elem_classes="gr-form"):
            gr.Markdown("### ğŸ¤– Interactive Medical Information Assistant")
            gr.Markdown("*Ask questions about health topics, symptoms, and general medical information*")

            chatbot_interface = gr.Chatbot(
                label="ğŸ’¬ Medical Information Assistant",
                height=450,
                type="messages",
                placeholder="Ask me about health topics, symptoms, or general medical questions...",
                show_copy_button=True
            )

            with gr.Row():
                message_input = gr.Textbox(
                    label="ğŸ’­ Your Health Question",
                    placeholder="Ask about symptoms, health tips, conditions, prevention...",
                    scale=4,
                    info="Type your question and press Enter or click Send"
                )

                send_button = gr.Button(
                    "ğŸ“¤ Send",
                    variant="primary",
                    scale=1
                )

            # Example questions
            gr.HTML("""
            <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                <strong>ğŸ’¡ Try asking about:</strong><br>
                â€¢ "What should I do for a headache?"<br>
                â€¢ "How can I lower my blood pressure?"<br>
                â€¢ "What are signs of diabetes?"<br>
                â€¢ "How much exercise do I need?"<br>
                â€¢ "What foods are good for heart health?"
            </div>
            """)

            message_input.submit(
                fn=medical_qa_chat,
                inputs=[message_input, chatbot_interface],
                outputs=[message_input, chatbot_interface]
            )

            send_button.click(
                fn=medical_qa_chat,
                inputs=[message_input, chatbot_interface],
                outputs=[message_input, chatbot_interface]
            )

        # Footer with additional information
        gr.HTML("""
        <div style="text-align: center; margin-top: 25px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 15px; backdrop-filter: blur(10px);">
            <h3 style="color: white; margin: 0 0 10px 0;">ğŸ”¬ Powered by Lightweight AI Technology</h3>
            <p style="color: rgba(255,255,255,0.9); margin: 0; line-height: 1.6;">
                This tool uses rule-based medical knowledge to provide quick health guidance.<br>
                <strong>Remember:</strong> AI cannot replace professional medical consultation.<br>
                <em>Always seek qualified medical advice for health concerns.</em>
            </p>
            <div style="margin-top: 15px; font-size: 0.9em; color: rgba(255,255,255,0.8);">
                âš¡ Optimized for Google Colab | ğŸš€ Fast & Lightweight | ğŸ”’ No Personal Data Stored
            </div>
        </div>
        """)

    return app

# ================================================================
# LAUNCH APPLICATION
# ================================================================

print("ğŸš€ Creating Medical AI Assistant...")

# Create and launch the app
medical_app = create_medical_app()

print("âœ… App created successfully!")
print("ğŸŒ Launching application...")

# Launch with Colab-optimized settings
medical_app.launch(
    share=True,          # Creates public link for sharing
    debug=False,         # Cleaner output in Colab
    server_port=None,    # Auto-select available port
    quiet=False,         # Show launch messages
    show_error=True,     # Display errors for debugging
    height=800,          # Optimal height for Colab
    width="100%"         # Full width in Colab
)

print("ğŸ‰ Medical AI Assistant is now running!")
print("ğŸ“± Use the public link to access from any device")
print("ğŸ’¡ The app will stay active as long as this Colab session is running")